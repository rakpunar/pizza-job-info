<html>
    <head>
        <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
        <meta http-equiv="Pragma" content="no-cache">
        <meta http-equiv="Expires" content="0">
        <title>API Tracker</title>
    </head>
    <div id="container" style="width: 300px; position: fixed; right: 20px; top: 20px; font-family: Arial; color: white;">
        <div style="background: rgba(30,30,30,0.95); padding: 8px; border-radius: 5px 5px 0 0;">
            <span style="font-size: 12px; color: #999;">API DATA - USER 227724</span>
            <button onclick="refreshData()" style="float:right; background: none; border: none; color: white; cursor: pointer;">ðŸ”„</button>
        </div>

        <div style="background: rgba(30,30,30,0.95); padding: 10px; border-radius: 0 0 5px 5px;">
            <div style="margin-bottom: 15px;">
                <div style="color: #999; font-size: 12px;">OYUNCU DURUMU</div>
                <div id="playerStatus" style="font-size: 14px; margin-top: 3px;">YÃ¼kleniyor...</div>
            </div>

            <div style="margin-bottom: 15px;">
                <div style="color: #999; font-size: 12px;">ENVANTER</div>
                <div id="inventory" style="font-size: 14px; margin-top: 3px;">YÃ¼kleniyor...</div>
            </div>

            <div>
                <div style="color: #999; font-size: 12px;">BAKÄ°YE</div>
                <div id="wealth" style="font-size: 14px; margin-top: 3px;">YÃ¼kleniyor...</div>
            </div>
        </div>
    </div>

    <script>
        const API_URL = 'tycoon-2epova.users.cfx.re/status';
        const USER_ID = '227724';
        const API_KEY = 'MXmNGqARCoXgKgZOp7LO13omYG9D23tfkNVik'; // API key buraya

        // Ä°tem isimlerini dÃ¼zeltme
        const formatItemName = (name) => {
            const parts = name.split('|');
            if (parts.length > 1) {
                return parts[parts.length - 1].toUpperCase();
            }
            return name.replace(/_/g, ' ').toUpperCase();
        };

        async function fetchAPI(endpoint) {
            try {
                const response = await fetch(`https://${API_URL}${endpoint}`, {
                    headers: {'X-Tycoon-Key': API_KEY}
                });
                return await response.json();
            } catch (error) {
                console.error(`Hata: ${endpoint}`, error);
                return null;
            }
        }

        async function refreshData() {
            // Temel veri
            const userData = await fetchAPI(`/dataadv/${USER_ID}`);
            // Oyuncu pozisyonu ve aktif durum
            const mapData = await fetchAPI('/map/positions.json');
            // Bakiye
            const wealthData = await fetchAPI(`/wealth/${USER_ID}`);

            // Oyuncu durumu
            let status = 'Ã‡evrimdÄ±ÅŸÄ±';
            if (mapData?.players) {
                const player = mapData.players.find(p => p[2] == USER_ID);
                if (player) {
                    status = `Ã‡evrimiÃ§i<br>`;
                    status += `Ä°ÅŸ: ${player[5]?.name || 'Yok'}<br>`;
                    if (player[4]?.vehicle_name) {
                        status += `AraÃ§: ${player[4].vehicle_name}`;
                    }
                }
            }
            document.getElementById('playerStatus').innerHTML = status;

            // Envanter
            if (userData?.data?.inventory) {
                const invHtml = Object.entries(userData.data.inventory)
                    .sort((a, b) => b[1].amount - a[1].amount)
                    .map(([item, data]) => {
                        const name = formatItemName(item);
                        const amount = data.amount || 0;
                        if (amount > 0) {
                            return `<div style="display: flex; justify-content: space-between; padding: 2px 0; border-bottom: 1px solid rgba(255,255,255,0.1)">
                                <span>${name}:</span>
                                <span>${amount}</span>
                            </div>`;
                        }
                    })
                    .filter(Boolean)
                    .join('');
                document.getElementById('inventory').innerHTML = invHtml || 'Envanter boÅŸ';
            }

            // Bakiye
            if (wealthData) {
                const wealth = `CÃ¼zdan: $${wealthData.wallet?.toLocaleString() || 0}<br>
                               Banka: $${wealthData.bank?.toLocaleString() || 0}<br>
                               BorÃ§: $${wealthData.loan?.toLocaleString() || 0}`;
                document.getElementById('wealth').innerHTML = wealth;
            }
        }

        refreshData();
        setInterval(refreshData, 30000);
    </script>
</html>

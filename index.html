<html>
    <title>Basic Tracker</title>
    <div style="width: 300px; position: fixed; right: 20px; top: 20px; font-family: Arial; color: white;">
        <div style="background: rgba(30,30,30,0.9); padding: 10px; border-radius: 5px; margin-bottom: 10px;">
            <div style="color: #999; font-size: 12px;">OYUNCU BİLGİSİ</div>
            <div style="font-size: 16px; margin-top: 3px;" id="playerInfo">-</div>
        </div>

        <div style="background: rgba(30,30,30,0.9); padding: 10px; border-radius: 5px; margin-bottom: 10px;">
            <div style="color: #999; font-size: 12px;">KONUM</div>
            <div style="font-size: 16px; margin-top: 3px;" id="location">-</div>
        </div>

        <div style="background: rgba(30,30,30,0.9); padding: 10px; border-radius: 5px; margin-bottom: 10px;">
            <div style="color: #999; font-size: 12px;">ENVANTER</div>
            <div style="font-size: 16px; margin-top: 3px;" id="inventory">-</div>
        </div>
    </div>

    <script>
        window.addEventListener("message", (event) => {
            const evt = event.data;
            if (!evt.data) return;
            
            // Oyuncu bilgisi
            if (evt.data.name || evt.data.user_id) {
                document.getElementById('playerInfo').textContent = 
                    `${evt.data.name || '-'} [ID: ${evt.data.user_id || '-'}]`;
            }

            // Konum
            if (evt.data.zoneName || evt.data.street) {
                document.getElementById('location').textContent = 
                    `${evt.data.zoneName || ''} ${evt.data.street ? `- ${evt.data.street}` : ''}`;
            }

            // Envanter kontrolü
            if (evt.data.inventory) {
                try {
                    const inv = JSON.parse(evt.data.inventory);
                    const pizzaItems = Object.entries(inv).reduce((acc, [key, value]) => {
                        if (key.toLowerCase().includes('pizza')) {
                            acc[key] = value;
                        }
                        return acc;
                    }, {});
                    
                    if (Object.keys(pizzaItems).length > 0) {
                        document.getElementById('inventory').innerHTML = Object.entries(pizzaItems)
                            .map(([item, count]) => `${item}: ${count}`).join('<br>');
                    } else {
                        document.getElementById('inventory').textContent = 'Pizza malzemesi yok';
                    }
                } catch (e) {
                    console.error('Envanter parse hatası:', e);
                }
            }
        });

        window.parent.postMessage({type: "getData"}, "*");

        window.addEventListener('keydown', (e) => {
            if (e.key === "Escape") {
                window.parent.postMessage({type: "pin"}, "*");
            }
        });
    </script>
</html>
